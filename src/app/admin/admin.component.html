<body>
    <div style="height: 100%; overflow: hidden;">
      <mat-toolbar color="primary" >
        <mat-toolbar-row>
          <button mat-icon-button (click)="sidenav.toggle()" fxShow="true" fxHide.gt-sm>
            <mat-icon>menu</mat-icon>
          </button>
            <mat-icon fxShow="true" fxHide.gt-sm style="margin-left: auto;">person</mat-icon>
            <span fxShow="true" fxHide.gt-sm  style="margin-left: 2px;">{{userName}}</span>
          <div fxShow="true" fxHide.lt-md fxFlex>
             <!--The following menu items will be hidden on both SM and XS screen sizes -->
  
              <mat-nav-list fxLayout="row" fxLayoutAlign="center">
                <mat-list fxFlex>
                  <mat-list-item>

                    <button mat-button [matMenuTriggerFor]="patientMenu" class="button-data">
                        <mat-icon style="margin-bottom: 4px;"> group</mat-icon>
                        Pacjeci
                    </button>
                    <mat-menu #patientMenu="matMenu" xPosition="before">
                        <button mat-menu-item (click)="onNewPatient()" class="mat-button">
                            <mat-icon>person_add</mat-icon>
                            Dodaj pacjenta
                        </button>
                        <button mat-menu-item (click)="onPatients()" class="mat-button">
                            <mat-icon>table_chart</mat-icon>
                            Pokaż pacjentów
                        </button>
                    </mat-menu>

                    <button mat-button [matMenuTriggerFor]="doctorMenu" class="button-data">
                      <mat-icon style="margin-bottom: 4px;"> group</mat-icon>
                      Lekarze
                  </button>
                  <mat-menu #doctorMenu="matMenu" xPosition="before">
                      <button mat-menu-item (click)="onNewDoctor()" class="mat-button">
                          <mat-icon>person_add</mat-icon>
                          Dodaj lekarza
                      </button>
                      <button mat-menu-item (click)="onDoctors()" class="mat-button">
                          <mat-icon>table_chart</mat-icon>
                          Pokaż lekarzy
                      </button>
                  </mat-menu>

                  <button mat-button [matMenuTriggerFor]="visitMenu" class="button-data">
                    <mat-icon style="margin-bottom: 4px;"> table_chart</mat-icon>
                    Wizyty
                </button>
                <mat-menu #visitMenu="matMenu" xPosition="before">
                    <button mat-menu-item (click)="onNewVisit()" class="mat-button">
                        <mat-icon>add_box</mat-icon>
                        Dodaj
                    </button>
                    <button mat-menu-item (click)="onVisits()" class="mat-button">
                        <mat-icon>wysiwyg</mat-icon>
                        Zakończone
                    </button>
                    <button mat-menu-item (click)="onUnconfirmedVisits()" class="mat-button">
                      <mat-icon>new_releases</mat-icon>
                      Niepotwierdzone
                  </button>
                </mat-menu>








                
                    <button mat-button [matMenuTriggerFor]="stationMenu" class="button-logout">
                      <mat-icon>person</mat-icon>
                      {{userName}}
                    </button>
                    <mat-menu #stationMenu="matMenu" xPosition="before">
                      <button mat-menu-item class="mat-button">
                        <mat-icon>settings</mat-icon>
                        Ustawienia
                      </button>
                      <button mat-menu-item (click)="onLogOut()" class="mat-button">
                        <mat-icon>logout</mat-icon>
                        Wyloguj się
                      </button>
                    </mat-menu>
  
                  </mat-list-item>
                </mat-list>
              </mat-nav-list>
          </div>
        </mat-toolbar-row>
      </mat-toolbar>
    
      <mat-sidenav-container fxFlexFill>
        <mat-sidenav #sidenav style="background: #3F51B5;">
          <mat-nav-list>
            <mat-list>

              <mat-list-item style="margin-top: 20px;">
                <button mat-button (click)="onNewPatient()" (click)="sidenav.toggle()" style="color: white;">
                  <mat-icon style="margin-bottom: 4px;"> person_add</mat-icon>
                  Dodaj pacjenta
                </button>
              </mat-list-item>

              <mat-list-item style="margin-top: 1px;">
                <button mat-button (click)="onPatients()" (click)="sidenav.toggle()" style="color: white;">
                  <mat-icon style="margin-bottom: 4px;"> table_chart</mat-icon>
                  Pokaż pacjentów
                </button>
              </mat-list-item>

              <mat-list-item style="margin-top: 20px;">
                <button mat-button (click)="onNewDoctor()" (click)="sidenav.toggle()" style="color: white;">
                  <mat-icon style="margin-bottom: 4px;"> person_add</mat-icon>
                  Dodaj lekarza
                </button>
              </mat-list-item>

              <mat-list-item style="margin-top: 1px;">
                <button mat-button (click)="onDoctors()" (click)="sidenav.toggle()" style="color: white;">
                  <mat-icon style="margin-bottom: 4px;"> table_chart</mat-icon>
                  Pokaż lekarzy
                </button>
              </mat-list-item>

              <mat-list-item style="margin-top: 20px;">
                <button mat-button (click)="onNewVisit()" (click)="sidenav.toggle()" style="color: white;">
                  <mat-icon style="margin-bottom: 4px;"> add_box</mat-icon>
                  Dodaj wizytę
                </button>
              </mat-list-item>

              <mat-list-item style="margin-top: 1px;">
                <button mat-button (click)="onVisits()" (click)="sidenav.toggle()" style="color: white;">
                  <mat-icon style="margin-bottom: 4px;"> wysiwyg</mat-icon>
                  Pokaż zakończone
                </button>
              </mat-list-item>

              <mat-list-item style="margin-top: 1px;">
                <button mat-button (click)="onUnconfirmedVisits()" (click)="sidenav.toggle()" style="color: white;">
                  <mat-icon style="margin-bottom: 4px;"> new_releases</mat-icon>
                  Pokaż niepotwierdzone
                </button>
              </mat-list-item>

              <mat-list-item style="padding-top: 20px;">
                <button mat-button (click)="onLogOut()" style="color: #b8cef2;"> 
                  <mat-icon>logout</mat-icon>
                  Wyloguj się
                </button>
              </mat-list-item>

            </mat-list>
          </mat-nav-list>
        </mat-sidenav>;
        <mat-sidenav-content fxFlexFill class="background">

            <div *ngIf="loadNewPatientForm" fxLayoutAlign="center center" fxFlexFill class="main-div" class="background-template">
                <mat-card fxFlex="350px" style="padding: auto; margin-top: 10px; margin-bottom: 75px;">
                    <mat-icon aria-hidden="false" aria-label="Example home icon" style="position: absolute; left: 50%;">
                        home
                    </mat-icon>
                    <form [formGroup]="newPatientForm" (ngSubmit)="onNewPatientSubmit()" fxLayoutAlign="streatch" fxLayout="column" class="register-form">
                        <mat-form-field>
                            <input matInput placeholder="Imię" type="text" formControlName="name" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field>
                            <input matInput placeholder="Nazwisko" type="text" formControlName="surname" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field>
                            <input matInput placeholder="Email" type="mail" formControlName="email" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                            <input matInput placeholder="Hasło" type="password" formControlName="password" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                            <input matInput placeholder="Telefon" type="number" formControlName="phone" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                            <input matInput placeholder="Pesel" type="number" formControlName="pesel" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                            <input matInput placeholder="Wiek" type="number" formControlName="age" class="register-form" required>
                        </mat-form-field>
                        <mat-radio-group formControlName="gender" required class="register-form" style="padding-bottom: 20px;" >
                            <mat-radio-button value="M">Mężczyzna</mat-radio-button>
                            <mat-radio-button value="K" style="margin-left: 10px;">Kobieta</mat-radio-button>
                        </mat-radio-group>
                        <button mat-raised-button color="primary" class="register-form">
                            <mat-icon>person_add</mat-icon>
                            Dodaj
                        </button>
        
                    </form>
                </mat-card>
            </div>

            <div *ngIf="loadPatients" style="min-width: 500px;">
                <table mat-table [dataSource]="patients" class="mat-elevation-z8">
                  
                  <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef class="table-element"> Id </th>
                    <td mat-cell *matCellDef="let element" class="table-element"> {{element.id + "."}} </td>
                  </ng-container>
        
                  <ng-container matColumnDef="patient">
                    <th mat-header-cell *matHeaderCellDef class="table-element"> Pacjent </th>
                    <td mat-cell *matCellDef="let element" class="table-element"> {{element.name[0] + "." + element.surname}} </td>
                  </ng-container>
          
                  <ng-container matColumnDef="age">
                    <th mat-header-cell *matHeaderCellDef class="table-element"> Wiek </th>
                    <td mat-cell *matCellDef="let element" class="table-element"> {{element.age}} </td>
                  </ng-container>
          
                  <ng-container matColumnDef="gender">
                    <th mat-header-cell *matHeaderCellDef class="table-element"> Płeć </th>
                    <td mat-cell *matCellDef="let element" class="table-element"> {{element.gender}} </td>
                  </ng-container>
                  
                  <ng-container matColumnDef="pesel">
                    <th mat-header-cell *matHeaderCellDef class="table-element"> Pesel </th>
                    <td mat-cell *matCellDef="let element" class="table-element"> {{element.pesel}} </td>
                  </ng-container> 

                  <ng-container matColumnDef="phone">
                    <th mat-header-cell *matHeaderCellDef class="table-element"> Telefon </th>
                    <td mat-cell *matCellDef="let element" class="table-element"> {{element.phone}} </td>
                  </ng-container>

                  <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef class="table-element"> Status </th>
                    <td mat-cell *matCellDef="let element" class="table-element"> 
                      <button mat-icon-button 
                      (click)="onEditPatient(element)" 
                      color="primary" >
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button mat-icon-button 
                        (click)="onDeletePatient(element.id)" 
                        color="primary" >
                        <mat-icon>delete</mat-icon>
                      </button>
                    </td>                     
                  </ng-container>
          
                  <tr mat-header-row *matHeaderRowDef="displayedColumnsPatients"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsPatients;"></tr>
                </table>
              </div>

              <div *ngIf="loadNewDoctorForm" fxLayoutAlign="center center" fxFlexFill class="main-div" class="background-template">
                <mat-card fxFlex="350px" style="padding: auto; margin-top: 10px; margin-bottom: 75px;" >
                    <mat-icon aria-hidden="false" aria-label="Example home icon" style="position: absolute; left: 50%;">
                        home
                    </mat-icon>
                    <form [formGroup]="newDoctorForm" (ngSubmit)="onNewDoctorSubmit()" fxLayoutAlign="streatch" fxLayout="column" class="register-form">
                        <mat-form-field>
                            <input matInput placeholder="Imię" type="text" formControlName="name" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field>
                            <input matInput placeholder="Nazwisko" type="text" formControlName="surname" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field>
                            <input matInput placeholder="Email" type="mail" formControlName="email" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                            <input matInput placeholder="Hasło" type="password" formControlName="password" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                            <input matInput placeholder="Telefon" type="number" formControlName="phone" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                            <input matInput placeholder="Wiek" type="number" formControlName="age" class="register-form" required>
                        </mat-form-field>
                        <mat-form-field >
                          <input matInput placeholder="Specjalizacja" type="text" formControlName="specialty" class="register-form" required>
                      </mat-form-field>
                        <mat-radio-group formControlName="gender" required class="register-form" style="padding-bottom: 20px;" >
                            <mat-radio-button value="male">Mężczyzna</mat-radio-button>
                            <mat-radio-button value="female" style="margin-left: 10px;">Kobieta</mat-radio-button>
                        </mat-radio-group>
                        <button mat-raised-button color="primary" class="register-form">
                            <mat-icon>person_add</mat-icon>
                            Dodaj
                        </button>
                    </form>
                </mat-card>
            </div>

            <div *ngIf="loadDoctors" style="min-width: 500px;">
              <table mat-table [dataSource]="doctors" class="mat-elevation-z8">
                
                <ng-container matColumnDef="id">
                  <th mat-header-cell *matHeaderCellDef class="table-element"> Id </th>
                  <td mat-cell *matCellDef="let element" class="table-element"> {{element.id + "."}} </td>
                </ng-container>
      
                <ng-container matColumnDef="doctor">
                  <th mat-header-cell *matHeaderCellDef class="table-element"> Lekarz </th>
                  <td mat-cell *matCellDef="let element" class="table-element"> {{element.name[0] + "." + element.surname}} </td>
                </ng-container>

                <ng-container matColumnDef="specialty">
                  <th mat-header-cell *matHeaderCellDef class="table-element"> Wiek </th>
                  <td mat-cell *matCellDef="let element" class="table-element"> {{element.specialty}} </td>
                </ng-container>
        
                <ng-container matColumnDef="age">
                  <th mat-header-cell *matHeaderCellDef class="table-element"> Wiek </th>
                  <td mat-cell *matCellDef="let element" class="table-element"> {{element.age}} </td>
                </ng-container>
        
                <ng-container matColumnDef="gender">
                  <th mat-header-cell *matHeaderCellDef class="table-element"> Płeć </th>
                  <td mat-cell *matCellDef="let element" class="table-element"> {{element.gender}} </td>
                </ng-container>

                <ng-container matColumnDef="phone">
                  <th mat-header-cell *matHeaderCellDef class="table-element"> Telefon </th>
                  <td mat-cell *matCellDef="let element" class="table-element"> {{element.phone}} </td>
                </ng-container>

                <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef class="table-element"> Status </th>
                  <td mat-cell *matCellDef="let element" class="table-element"> 
                    <button mat-icon-button (click)="onEditDoctor(element)" color="primary" >
                      <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button (click)="onDeleteDoctor(element.id)" color="primary" >
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>                     
                </ng-container>
        
                <tr mat-header-row *matHeaderRowDef="displayedColumnsDoctors"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsDoctors;"></tr>
              </table>
            </div>


        <div *ngIf="loadNewVisitForm" fxLayoutAlign="center center" class="main-div">
          <mat-card fxFlex="350px" style="margin-top: 30px; padding: auto;" >
  
            <form [formGroup]="newVisitForm" (ngSubmit)="onSubmitNewVisit()" fxLayoutAlign="streatch" fxLayout="column">
              <mat-form-field class="example-full-width" appearance="fill" class="register-form">
                <mat-label>Pacjent</mat-label>
                <input type="text"
                        placeholder="Wybierz"
                        aria-label="Number"
                        matInput
                        [formControl]="newPatientControl"
                        [matAutocomplete]="autoPateint"
                        formControlName="patient" 
                        required>
                  <mat-autocomplete autoActiveFirstOption #autoPateint="matAutocomplete">
                    <mat-option *ngFor="let option of filteredOptionsPatient | async" [value]="option">
                      {{option}}
                    </mat-option>
                  </mat-autocomplete>
              </mat-form-field>

              <mat-form-field class="example-full-width" appearance="fill" class="register-form">
                <mat-label>Specjalizacja</mat-label>
                <input type="text"
                        placeholder="Wybierz"
                        aria-label="Number"
                        matInput
                        [formControl]="newSpecialtyControl"
                        [matAutocomplete]="autoSpecialty"
                        formControlName="specialty" 
                        required>
                  <mat-autocomplete autoActiveFirstOption #autoSpecialty="matAutocomplete" (optionSelected)="onSpecialitySelect()">
                    <mat-option *ngFor="let option of filteredOptionsSpecialty | async" [value]="option">
                      {{option}}
                    </mat-option>
                  </mat-autocomplete>
              </mat-form-field>

                <mat-form-field *ngIf="isSpecialitySelected" class="example-full-width" appearance="fill" class="register-form">
                  <mat-label>Lekarz</mat-label>
                  <input type="text"
                          placeholder="Wybierz"
                          aria-label="Number"
                          matInput
                          [formControl]="newVisitControl"
                          [matAutocomplete]="auto"
                          formControlName="doctor" 
                          required>
                    <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" >
                      <mat-option *ngFor="let option of filteredOptionsDoctor | async" [value]="option">
                        {{option}}
                      </mat-option>
                    </mat-autocomplete>
                </mat-form-field>

                <mat-form-field  class="example-full-width" class="register-form" appearance="fill">
                  <input matInput placeholder="Gabinet *" type="number" formControlName="room"  required>
                </mat-form-field>             
  
              <mat-form-field class="example-full-width" appearance="fill" class="register-form">
                <input matInput [ngxMatDatetimePicker]="picker" placeholder="Wybierz datę *" formControlName="date" required>             
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>        
                <ngx-mat-datetime-picker #picker></ngx-mat-datetime-picker>
              </mat-form-field>
              
              <div class="confirm-visit">
                <button mat-raised-button class="register-form" color="primary">
                  Potwierdz
                 </button>
              </div>             
            </form>
          </mat-card> 
        </div>

        <div *ngIf="loadVisits" style="min-width: 500px;">
          <table mat-table [dataSource]="visits" class="mat-elevation-z8">
            
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Id </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.id + "."}} </td>
            </ng-container>
  
            <ng-container matColumnDef="patient">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Pacjent </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.patient.name[0] + "." + element.patient.surname}} </td>
            </ng-container>
    
            <ng-container matColumnDef="doctor">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Lekarz </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.doctor.name[0] + "." + element.doctor.surname}} </td>
            </ng-container>
    
            <ng-container matColumnDef="room">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Gabinet </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.room}} </td>
            </ng-container>
            
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Data </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.dateAsString}} </td>
            </ng-container> 
    
            <tr mat-header-row *matHeaderRowDef="displayedColumnsVisits"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsVisits;"></tr>
          </table>
        </div>

        <div *ngIf="loadUnconfirmedVisits" style="min-width: 500px;">
          <table mat-table [dataSource]="visitsUnconfirmed" class="mat-elevation-z8">
            
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Id </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.id + "."}} </td>
            </ng-container>
  
            <ng-container matColumnDef="patient">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Pacjent </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.patient.name[0] + "." + element.patient.surname}} </td>
            </ng-container>
    
            <ng-container matColumnDef="doctor">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Lekarz </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.doctor.name[0] + "." + element.doctor.surname}} </td>
            </ng-container>
             
            <ng-container matColumnDef="date">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Data </th>
              <td mat-cell *matCellDef="let element" class="table-element"> {{element.dateAsString}} </td>
            </ng-container> 

            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef class="table-element"> Status </th>
              <td mat-cell *matCellDef="let element" class="table-element"> 
                <button mat-icon-button (click)="onConfirmVisit(element.id)" color="primary" >
                  <mat-icon>done</mat-icon>
                </button>
              </td>                     
            </ng-container>
    
            <tr mat-header-row *matHeaderRowDef="displayedColumnsVisitsUnconfirmed"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsVisitsUnconfirmed;"></tr>
          </table>
        </div>
  
        </mat-sidenav-content>
      </mat-sidenav-container>
    </div>
  </body>